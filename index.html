<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>X-Ray Goggles - Hackasaurus</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f8fafc;
            color: #1e293b;
            line-height: 1.6;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .logo {
            font-size: 2.5em;
            font-weight: bold;
            color: #2563eb;
            margin-bottom: 10px;
        }
        
        .nav {
            margin-bottom: 30px;
        }
        
        .nav a {
            color: #2563eb;
            text-decoration: none;
            margin: 0 15px;
            font-weight: 500;
        }
        
        .nav a:hover {
            text-decoration: underline;
        }
        
        .mozilla-badge {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .mozilla-badge img {
            height: 40px;
        }
        
        h1 {
            color: #1e40af;
            font-size: 2.2em;
            text-align: center;
            margin-bottom: 20px;
            font-weight: 700;
        }
        
        .browser-warning {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .steps {
            background-color: #f0f9ff;
            padding: 30px;
            border-radius: 12px;
            margin: 30px 0;
            border: 1px solid #e0f2fe;
        }
        
        .steps h2 {
            color: #0369a1;
            margin-top: 0;
            font-weight: 600;
        }
        
        .step {
            margin: 20px 0;
            padding: 20px;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #0ea5e9;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .step strong {
            color: #0369a1;
        }
        
        .url-box {
            background-color: #f1f5f9;
            border: 1px solid #cbd5e1;
            padding: 12px;
            border-radius: 8px;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
            margin: 10px 0;
            color: #475569;
        }
        
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .feature {
            background-color: #f8fafc;
            padding: 24px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid #e2e8f0;
            transition: all 0.2s ease;
        }
        
        .feature:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .feature h3 {
            color: #1e40af;
            margin-top: 0;
            font-weight: 600;
        }
        
        .achievement {
            background-color: #fef3c7;
            border: 1px solid #fde68a;
            padding: 24px;
            border-radius: 12px;
            margin: 30px 0;
            text-align: center;
        }
        
        .achievement h3 {
            color: #92400e;
            margin-top: 0;
            font-weight: 600;
        }
        
        .social {
            text-align: center;
            margin: 30px 0;
        }
        
        .social a {
            color: #2563eb;
            text-decoration: none;
            font-weight: 600;
        }
        
        .social a:hover {
            text-decoration: underline;
            color: #1d4ed8;
        }
        
        .links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .link-section h3 {
            color: #1e40af;
            margin-top: 0;
            font-weight: 600;
        }
        
        .link-section ul {
            list-style: none;
            padding: 0;
        }
        
        .link-section li {
            margin: 8px 0;
        }
        
        .link-section a {
            color: #2563eb;
            text-decoration: none;
            font-weight: 500;
        }
        
        .link-section a:hover {
            text-decoration: underline;
            color: #1d4ed8;
        }
        
        .languages {
            text-align: center;
            margin: 30px 0;
            padding: 24px;
            background-color: #f8fafc;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
        }
        
        .languages h3 {
            color: #1e40af;
            margin-top: 0;
            font-weight: 600;
        }
        
        .languages a {
            color: #2563eb;
            text-decoration: none;
            margin: 0 10px;
            font-weight: 500;
        }
        
        .languages a:hover {
            text-decoration: underline;
            color: #1d4ed8;
        }
        
        .partners {
            text-align: center;
            margin: 30px 0;
        }
        
        .partners h3 {
            color: #1e40af;
            font-weight: 600;
        }
        
        .legal {
            text-align: center;
            margin: 30px 0;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
            color: #64748b;
        }
        
        .legal a {
            color: #2563eb;
            text-decoration: none;
            margin: 0 10px;
            font-weight: 500;
        }
        
        .legal a:hover {
            text-decoration: underline;
            color: #1d4ed8;
        }
        
        .copyright {
            text-align: center;
            margin-top: 20px;
            color: #64748b;
            font-size: 0.9em;
        }
        
        /* X-Ray Goggles Styles */
        .goggles-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.1);
            z-index: 999999;
            pointer-events: none;
        }
        
        .goggles-highlight {
            position: absolute;
            border: 2px solid #2563eb;
            background: rgba(37, 99, 235, 0.1);
            pointer-events: none;
            z-index: 1000000;
        }
        
        .goggles-toolbar {
            position: fixed;
            top: 10px;
            right: 10px;
            background: #2563eb;
            color: white;
            padding: 12px;
            border-radius: 8px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-size: 12px;
            z-index: 1000001;
            box-shadow: 0 4px 20px rgba(37, 99, 235, 0.3);
        }
        
        .goggles-toolbar button {
            background: white;
            color: #2563eb;
            border: none;
            padding: 6px 12px;
            margin: 2px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 11px;
            font-weight: 600;
            transition: all 0.2s ease;
        }
        
        .goggles-toolbar button:hover {
            background: #f1f5f9;
            color: #1d4ed8;
        }
        
        .goggles-editor {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border: 2px solid #2563eb;
            border-radius: 12px;
            padding: 24px;
            z-index: 1000002;
            box-shadow: 0 10px 40px rgba(37, 99, 235, 0.2);
            min-width: 400px;
            max-width: 80%;
        }
        
        .goggles-editor h3 {
            margin-top: 0;
            color: #1e40af;
            font-weight: 600;
        }
        
        .goggles-editor textarea {
            width: 100%;
            height: 200px;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace;
            font-size: 12px;
            border: 1px solid #cbd5e1;
            padding: 12px;
            margin: 10px 0;
            border-radius: 8px;
            background: #f8fafc;
        }
        
        .goggles-editor button {
            background: #2563eb;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
        }
        
        .goggles-editor button:hover {
            background: #1d4ed8;
            transform: translateY(-1px);
        }
        
        .goggles-help {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border: 2px solid #2563eb;
            border-radius: 12px;
            padding: 24px;
            z-index: 1000003;
            box-shadow: 0 10px 40px rgba(37, 99, 235, 0.2);
            max-width: 500px;
        }
        
        .goggles-help h3 {
            margin-top: 0;
            color: #1e40af;
            font-weight: 600;
        }
        
        .goggles-help ul {
            text-align: left;
        }
        
        .goggles-help li {
            margin: 10px 0;
        }
        
        .bookmarklet-button {
            display: inline-block;
            background: #ff6b35;
            color: white;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
            margin: 10px;
            cursor: move;
            user-select: none;
        }
        
        .bookmarklet-button:hover {
            background: #e55a2b;
            color: white;
        }
        
        .demo-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }
        
        .demo-image {
            max-width: 200px;
            height: auto;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .install-button {
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            color: white;
            border: none;
            padding: 16px 32px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(37, 99, 235, 0.3);
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        .install-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(37, 99, 235, 0.4);
            background: linear-gradient(135deg, #1d4ed8, #2563eb);
        }
        
        .install-button:active {
            transform: translateY(0);
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 10000;
            display: none;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            max-width: 500px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .modal h3 {
            color: #1e40af;
            margin-top: 0;
            font-weight: 600;
        }
        
        .modal button {
            background: #2563eb;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px;
            font-weight: 600;
            transition: all 0.2s ease;
        }
        
        .modal button:hover {
            background: #1d4ed8;
            transform: translateY(-1px);
        }
    </style>
</head>
<body>
    <div class="container">

        <h1>X-Ray Goggles</h1>
        <p style="text-align: center; font-size: 1.2em; margin-bottom: 30px;">Remix, make and share webpages instantly.</p>


        <div class="steps">
            <div style="text-align: center; margin: 30px 0;">
                <button onclick="installBookmarklet()" class="install-button">üîç Install X-Ray Goggles</button>
            </div>
        </div>

        <div class="demo-section">
            <h3>Try the X-Ray Goggles!</h3>
            <p>Click the bookmarklet above, then hover over this image and press <strong>R</strong> to edit it:</p>
            <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRkY2QjM1Ii8+CjxjaXJjbGUgY3g9IjEwMCIgY3k9IjEwMCIgcj0iNDAiIGZpbGw9IndoaXRlIi8+Cjx0ZXh0IHg9IjEwMCIgeT0iMTEwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IiNGRjZCMzUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPk1ha2UgbWUhPC90ZXh0Pgo8L3N2Zz4=" alt="Demo image - Make me!" class="demo-image">
            <p><em>This is a demo image. Try editing its source with the X-Ray Goggles!</em></p>
        </div>

        <div class="features">
            <div class="feature">
                <h3>‚Ä¶ And then, the world!</h3>
                <p>Install the goggles into your bookmarks bar and use them to remix <em>any</em> web page!</p>
            </div>
            
            <div class="feature">
                <h3>Share with friends!</h3>
                <p>Tap <strong>P</strong> to publish your hacks and share your creations with your friends.</p>
            </div>
            
            <div class="feature">
                <h3>Become a ninja!</h3>
                <p>Tap <strong>H</strong> to learn about more awesome powers like undo/redo and computed style editing.</p>
            </div>
        </div>



    </div>

    <!-- Installation Modal -->
    <div id="installModal" class="modal">
        <div class="modal-content">
            <h3>üîç Install X-Ray Goggles</h3>
            <p>To install the X-Ray Goggles bookmarklet:</p>
            <ol style="text-align: left; margin: 20px 0;">
                <li>Drag the button below to your bookmarks bar</li>
                <li>Or right-click the button and select "Bookmark this link"</li>
                <li>Then click the bookmark on any webpage to activate X-Ray Goggles!</li>
            </ol>
            <div style="margin: 20px 0;">
                <a href="javascript:(function(){if(window.XRayGoggles){if(window.XRayGoggles.active){window.XRayGoggles.deactivate();}else{window.XRayGoggles.activate();}}else{window.XRayGoggles={active:false,overlay:null,highlight:null,toolbar:null,currentElement:null,activate:function(){if(this.active)return;this.active=true;this.createOverlay();this.createToolbar();this.bindEvents();this.showHelp();},deactivate:function(){if(!this.active)return;this.active=false;this.removeOverlay();this.removeToolbar();this.unbindEvents();this.closeAllModals();},createOverlay:function(){this.overlay=document.createElement('div');this.overlay.style.cssText='position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.1);z-index:999999;pointer-events:none';document.body.appendChild(this.overlay);this.highlight=document.createElement('div');this.highlight.style.cssText='position:absolute;border:2px solid #2563eb;background:rgba(37,99,235,0.1);pointer-events:none;z-index:1000000';document.body.appendChild(this.highlight);},removeOverlay:function(){if(this.overlay){this.overlay.remove();this.overlay=null;}if(this.highlight){this.highlight.remove();this.highlight=null;}},createToolbar:function(){this.toolbar=document.createElement('div');this.toolbar.style.cssText='position:fixed;top:10px;right:10px;background:#2563eb;color:white;padding:12px;border-radius:8px;font-family:Arial,sans-serif;font-size:12px;z-index:1000001;box-shadow:0 4px 20px rgba(37,99,235,0.3)';this.toolbar.innerHTML='<div>X-Ray Goggles Active</div><button onclick=\"XRayGoggles.showHelp()\">H - Help</button><button onclick=\"XRayGoggles.publish()\">P - Publish</button><button onclick=\"XRayGoggles.deactivate()\">Exit</button>';document.body.appendChild(this.toolbar);},removeToolbar:function(){if(this.toolbar){this.toolbar.remove();this.toolbar=null;}},bindEvents:function(){this.mouseMoveHandler=this.handleMouseMove.bind(this);this.clickHandler=this.handleClick.bind(this);this.keyHandler=this.handleKeyPress.bind(this);document.addEventListener('mousemove',this.mouseMoveHandler);document.addEventListener('click',this.clickHandler);document.addEventListener('keydown',this.keyHandler);},unbindEvents:function(){document.removeEventListener('mousemove',this.mouseMoveHandler);document.removeEventListener('click',this.clickHandler);document.removeEventListener('keydown',this.keyHandler);},handleMouseMove:function(e){if(!this.active)return;var element=document.elementFromPoint(e.clientX,e.clientY);if(element&&element!==this.currentElement){this.currentElement=element;this.highlightElement(element);}},handleClick:function(e){if(!this.active)return;e.preventDefault();e.stopPropagation();if(this.currentElement){this.editElement(this.currentElement);}},handleKeyPress:function(e){if(!this.active)return;switch(e.key.toLowerCase()){case'r':e.preventDefault();if(this.currentElement){this.editElement(this.currentElement);}break;case'p':e.preventDefault();this.publish();break;case'h':e.preventDefault();this.showHelp();break;case'escape':e.preventDefault();this.closeAllModals();break;}},highlightElement:function(element){if(!this.highlight)return;var rect=element.getBoundingClientRect();this.highlight.style.left=(rect.left+window.scrollX)+'px';this.highlight.style.top=(rect.top+window.scrollY)+'px';this.highlight.style.width=rect.width+'px';this.highlight.style.height=rect.height+'px';this.highlight.style.display='block';},editElement:function(element){var editor=document.createElement('div');editor.style.cssText='position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:white;border:2px solid #2563eb;border-radius:12px;padding:24px;z-index:1000002;box-shadow:0 10px 40px rgba(37,99,235,0.2);min-width:400px;max-width:80%';editor.innerHTML='<h3>Edit Element</h3><p><strong>Tag:</strong> '+element.tagName.toLowerCase()+'</p><p><strong>Current HTML:</strong></p><textarea style=\"width:100%;height:200px;font-family:monospace;font-size:12px;border:1px solid #cbd5e1;padding:12px;margin:10px 0;border-radius:8px;background:#f8fafc\">'+element.outerHTML+'</textarea><br><button onclick=\"XRayGoggles.applyEdit(this)\" style=\"background:#2563eb;color:white;border:none;padding:10px 20px;margin:5px;border-radius:8px;cursor:pointer;font-weight:600\">Apply Changes</button><button onclick=\"XRayGoggles.closeModal(this)\" style=\"background:#2563eb;color:white;border:none;padding:10px 20px;margin:5px;border-radius:8px;cursor:pointer;font-weight:600\">Cancel</button>';document.body.appendChild(editor);this.currentModal=editor;},applyEdit:function(button){var editor=button.closest('div');var textarea=editor.querySelector('textarea');var newHTML=textarea.value;try{var temp=document.createElement('div');temp.innerHTML=newHTML;var newElement=temp.firstElementChild;if(newElement&&this.currentElement){this.currentElement.parentNode.replaceChild(newElement,this.currentElement);this.currentElement=newElement;}this.closeModal(button);}catch(e){alert('Invalid HTML. Please check your syntax.');}},publish:function(){var modal=document.createElement('div');modal.style.cssText='position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:white;border:2px solid #2563eb;border-radius:12px;padding:24px;z-index:1000002;box-shadow:0 10px 40px rgba(37,99,235,0.2);min-width:400px;max-width:80%';modal.innerHTML='<h3>Publish Your Hack</h3><p>Your hack has been saved! Here is what you can do:</p><ul style=\"text-align:left\"><li>Share the URL with friends</li><li>Take a screenshot of your changes</li><li>Copy the modified HTML</li></ul><p><strong>Current URL:</strong> '+window.location.href+'</p><button onclick=\"XRayGoggles.closeModal(this)\" style=\"background:#2563eb;color:white;border:none;padding:10px 20px;margin:5px;border-radius:8px;cursor:pointer;font-weight:600\">Close</button>';document.body.appendChild(modal);this.currentModal=modal;},showHelp:function(){var modal=document.createElement('div');modal.style.cssText='position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:white;border:2px solid #2563eb;border-radius:12px;padding:24px;z-index:1000003;box-shadow:0 10px 40px rgba(37,99,235,0.2);max-width:500px';modal.innerHTML='<h3>X-Ray Goggles Help</h3><ul><li><strong>Mouse over elements</strong> to highlight them</li><li><strong>Click or press R</strong> to edit an element</li><li><strong>Press P</strong> to publish your hack</li><li><strong>Press H</strong> to show this help</li><li><strong>Press Escape</strong> to close modals</li></ul><p><em>Try editing any element on this page!</em></p><button onclick=\"XRayGoggles.closeModal(this)\" style=\"background:#2563eb;color:white;border:none;padding:10px 20px;margin:5px;border-radius:8px;cursor:pointer;font-weight:600\">Got it!</button>';document.body.appendChild(modal);this.currentModal=modal;},closeModal:function(button){var modal=button.closest('div');if(modal){modal.remove();}},closeAllModals:function(){var modals=document.querySelectorAll('div[style*=\"position:fixed\"][style*=\"z-index:100000\"]');modals.forEach(function(modal){modal.remove();});}};this.activate();}})();" class="install-button" draggable="true">üîç X-Ray Goggles</a>
            </div>
            <button onclick="closeInstallModal()">Got it!</button>
        </div>
    </div>

    <script>
        // Installation function
        function installBookmarklet() {
            document.getElementById('installModal').style.display = 'flex';
        }
        
        function closeInstallModal() {
            document.getElementById('installModal').style.display = 'none';
        }
        
        // Close modal when clicking outside
        document.getElementById('installModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeInstallModal();
            }
        });
        // X-Ray Goggles Implementation
        (function() {
            'use strict';
            
            // Create the X-Ray Goggles namespace
            window.XRayGoggles = {
                active: false,
                overlay: null,
                highlight: null,
                toolbar: null,
                currentElement: null,
                clipboard: '',
                history: [],
                historyIndex: -1,
                
                activate: function() {
                    if (this.active) return;
                    
                    this.active = true;
                    this.createOverlay();
                    this.createToolbar();
                    this.bindEvents();
                    this.showHelp();
                },
                
                deactivate: function() {
                    if (!this.active) return;
                    
                    this.active = false;
                    this.removeOverlay();
                    this.removeToolbar();
                    this.unbindEvents();
                    this.closeAllModals();
                },
                
                createOverlay: function() {
                    this.overlay = document.createElement('div');
                    this.overlay.className = 'goggles-overlay';
                    document.body.appendChild(this.overlay);
                    
                    this.highlight = document.createElement('div');
                    this.highlight.className = 'goggles-highlight';
                    document.body.appendChild(this.highlight);
                },
                
                removeOverlay: function() {
                    if (this.overlay) {
                        this.overlay.remove();
                        this.overlay = null;
                    }
                    if (this.highlight) {
                        this.highlight.remove();
                        this.highlight = null;
                    }
                },
                
                createToolbar: function() {
                    this.toolbar = document.createElement('div');
                    this.toolbar.className = 'goggles-toolbar';
                    this.toolbar.innerHTML = `
                        <div>X-Ray Goggles Active</div>
                        <button onclick="XRayGoggles.showHelp()">H - Help</button>
                        <button onclick="XRayGoggles.publish()">P - Publish</button>
                        <button onclick="XRayGoggles.undo()">Undo</button>
                        <button onclick="XRayGoggles.deactivate()">Exit</button>
                    `;
                    document.body.appendChild(this.toolbar);
                },
                
                removeToolbar: function() {
                    if (this.toolbar) {
                        this.toolbar.remove();
                        this.toolbar = null;
                    }
                },
                
                bindEvents: function() {
                    this.mouseMoveHandler = this.handleMouseMove.bind(this);
                    this.clickHandler = this.handleClick.bind(this);
                    this.keyHandler = this.handleKeyPress.bind(this);
                    
                    document.addEventListener('mousemove', this.mouseMoveHandler);
                    document.addEventListener('click', this.clickHandler);
                    document.addEventListener('keydown', this.keyHandler);
                },
                
                unbindEvents: function() {
                    document.removeEventListener('mousemove', this.mouseMoveHandler);
                    document.removeEventListener('click', this.clickHandler);
                    document.removeEventListener('keydown', this.keyHandler);
                },
                
                handleMouseMove: function(e) {
                    if (!this.active) return;
                    
                    const element = document.elementFromPoint(e.clientX, e.clientY);
                    if (element && element !== this.currentElement) {
                        this.currentElement = element;
                        this.highlightElement(element);
                    }
                },
                
                handleClick: function(e) {
                    if (!this.active) return;
                    
                    e.preventDefault();
                    e.stopPropagation();
                    
                    if (this.currentElement) {
                        this.editElement(this.currentElement);
                    }
                },
                
                handleKeyPress: function(e) {
                    if (!this.active) return;
                    
                    switch(e.key.toLowerCase()) {
                        case 'r':
                            e.preventDefault();
                            if (this.currentElement) {
                                this.editElement(this.currentElement);
                            }
                            break;
                        case 'p':
                            e.preventDefault();
                            this.publish();
                            break;
                        case 'h':
                            e.preventDefault();
                            this.showHelp();
                            break;
                        case 'escape':
                            e.preventDefault();
                            this.closeAllModals();
                            break;
                    }
                },
                
                highlightElement: function(element) {
                    if (!this.highlight) return;
                    
                    const rect = element.getBoundingClientRect();
                    this.highlight.style.left = (rect.left + window.scrollX) + 'px';
                    this.highlight.style.top = (rect.top + window.scrollY) + 'px';
                    this.highlight.style.width = rect.width + 'px';
                    this.highlight.style.height = rect.height + 'px';
                    this.highlight.style.display = 'block';
                },
                
                editElement: function(element) {
                    this.saveToHistory();
                    
                    const editor = document.createElement('div');
                    editor.className = 'goggles-editor';
                    editor.innerHTML = `
                        <h3>Edit Element</h3>
                        <p><strong>Tag:</strong> ${element.tagName.toLowerCase()}</p>
                        <p><strong>Current HTML:</strong></p>
                        <textarea id="goggles-html">${element.outerHTML}</textarea>
                        <br>
                        <button onclick="XRayGoggles.applyEdit(this)">Apply Changes</button>
                        <button onclick="XRayGoggles.closeModal(this)">Cancel</button>
                    `;
                    
                    document.body.appendChild(editor);
                    this.currentModal = editor;
                },
                
                applyEdit: function(button) {
                    const editor = button.closest('.goggles-editor');
                    const textarea = editor.querySelector('textarea');
                    const newHTML = textarea.value;
                    
                    try {
                        // Create a temporary container to parse the HTML
                        const temp = document.createElement('div');
                        temp.innerHTML = newHTML;
                        const newElement = temp.firstElementChild;
                        
                        if (newElement && this.currentElement) {
                            // Replace the element
                            this.currentElement.parentNode.replaceChild(newElement, this.currentElement);
                            this.currentElement = newElement;
                        }
                        
                        this.closeModal(button);
                    } catch (e) {
                        alert('Invalid HTML. Please check your syntax.');
                    }
                },
                
                publish: function() {
                    const modal = document.createElement('div');
                    modal.className = 'goggles-editor';
                    modal.innerHTML = `
                        <h3>Publish Your Hack</h3>
                        <p>Your hack has been saved! Here's what you can do:</p>
                        <ul style="text-align: left;">
                            <li>Share the URL with friends</li>
                            <li>Take a screenshot of your changes</li>
                            <li>Copy the modified HTML</li>
                        </ul>
                        <p><strong>Current URL:</strong> ${window.location.href}</p>
                        <button onclick="XRayGoggles.closeModal(this)">Close</button>
                    `;
                    
                    document.body.appendChild(modal);
                    this.currentModal = modal;
                },
                
                showHelp: function() {
                    const modal = document.createElement('div');
                    modal.className = 'goggles-help';
                    modal.innerHTML = `
                        <h3>X-Ray Goggles Help</h3>
                        <ul>
                            <li><strong>Mouse over elements</strong> to highlight them</li>
                            <li><strong>Click or press R</strong> to edit an element</li>
                            <li><strong>Press P</strong> to publish your hack</li>
                            <li><strong>Press H</strong> to show this help</li>
                            <li><strong>Press Escape</strong> to close modals</li>
                            <li><strong>Undo button</strong> to revert changes</li>
                        </ul>
                        <p><em>Try editing the demo image above!</em></p>
                        <button onclick="XRayGoggles.closeModal(this)">Got it!</button>
                    `;
                    
                    document.body.appendChild(modal);
                    this.currentModal = modal;
                },
                
                saveToHistory: function() {
                    if (this.currentElement) {
                        this.history = this.history.slice(0, this.historyIndex + 1);
                        this.history.push({
                            element: this.currentElement,
                            html: this.currentElement.outerHTML
                        });
                        this.historyIndex = this.history.length - 1;
                    }
                },
                
                undo: function() {
                    if (this.historyIndex > 0) {
                        this.historyIndex--;
                        const state = this.history[this.historyIndex];
                        if (state && state.element && state.element.parentNode) {
                            state.element.outerHTML = state.html;
                        }
                    }
                },
                
                closeModal: function(button) {
                    const modal = button.closest('.goggles-editor, .goggles-help');
                    if (modal) {
                        modal.remove();
                    }
                },
                
                closeAllModals: function() {
                    const modals = document.querySelectorAll('.goggles-editor, .goggles-help');
                    modals.forEach(modal => modal.remove());
                }
            };
            
            // Auto-activate if this is the goggles page
            if (window.location.pathname.includes('goggles') || window.location.search.includes('goggles=true')) {
                setTimeout(() => {
                    XRayGoggles.activate();
                }, 1000);
            }
            
        })();
    </script>
</body>
</html>